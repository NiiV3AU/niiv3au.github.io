document.addEventListener("DOMContentLoaded",()=>{const SELECTORS={COPY_BTN:".copy-btn",BUTTON_TEXT:".button-text",CARD:".card",SKILL_ITEM:".skill-item",SKILL_ITEM_ACTION_ICON:"a.skill-item-action-icon",MORPH_BOX_PATH:"#morphBoxPath",MORPH_ARROW_PATH:"#morphArrowPath"};const copyButtons=document.querySelectorAll(SELECTORS.COPY_BTN);copyButtons.forEach((button)=>{const buttonTextSpan=button.querySelector(SELECTORS.BUTTON_TEXT);if(!buttonTextSpan){console.error(`Could not find “${SELECTORS.BUTTON_TEXT }” in the button:`,button);return}const originalText=buttonTextSpan.textContent;button.addEventListener("click",(event)=>{event.preventDefault();const textToCopy=button.dataset.clipboardText;if(textToCopy&&navigator.clipboard){navigator.clipboard.writeText(textToCopy).then(()=>{buttonTextSpan.textContent="Copied!";button.classList.add("copied-success");setTimeout(()=>{buttonTextSpan.textContent=originalText;button.classList.remove("copied-success")},1500)}).catch((err)=>{console.error("Error when copying to the clipboard:",err);if(buttonTextSpan){const originalColor=buttonTextSpan.style.color;buttonTextSpan.textContent="Error!";buttonTextSpan.style.color="red";setTimeout(()=>{buttonTextSpan.textContent=originalText;buttonTextSpan.style.color=originalColor},2000)}})}else{console.warn("No text found to copy or clipboard API not available.")}})});const mediaQuery=window.matchMedia("(min-width: 1536px)");let cardAnimationId=null;let cardsData=[];let mouseX=window.innerWidth/2;let mouseY=window.innerHeight/2;let actionIconsData=[];let gsapPluginsRegistered=false;const animationDuration=0.35;const animationEase="power2.inOut";const focusAnimationDelay=0.2;const normalStrokeColor="#dce4ee";const hoverStrokeColor="#7dcb95";function registerGsapPluginsOnce(){if(!gsapPluginsRegistered&&typeof gsap!=="undefined"&&typeof MorphSVGPlugin!=="undefined"){gsap.registerPlugin(MorphSVGPlugin);gsapPluginsRegistered=true;console.log("GSAP MorphSVGPlugin registered.")}else if(!gsapPluginsRegistered){console.warn("GSAP or MorphSVGPlugin not found. Morphing animations will not work.")}return gsapPluginsRegistered}function updateMousePosition(e){mouseX=e.clientX;mouseY=e.clientY}function updateAllCardRects(){cardsData.forEach((data)=>{if(data.element){data.rect=data.element.getBoundingClientRect()}})}function animateCards(){cardsData.forEach((data)=>{if(!data.element||!data.rect){return}const{element,rect,isHovered}=data;const cardCenterX=rect.left+rect.width/2;const cardCenterY=rect.top+rect.height/2;const deltaX=mouseX-cardCenterX;const deltaY=mouseY-cardCenterY;const maxRotation=8;const sensitivityFactor=300;let rotateY_anim=(deltaX/sensitivityFactor)*maxRotation;let rotateX_anim=(deltaY/sensitivityFactor)* -maxRotation;rotateX_anim=Math.max(-maxRotation,Math.min(maxRotation,rotateX_anim));rotateY_anim=Math.max(-maxRotation,Math.min(maxRotation,rotateY_anim));const currentScale=isHovered?1.075:1;element.style.transform=`perspective(1000px) rotateX(${ rotateX_anim }deg) rotateY(${ rotateY_anim }deg) scale(${ currentScale })`});cardAnimationId=requestAnimationFrame(animateCards)}function animateIconState(iconEntry,toHoverState,delay=0){if(!gsapPluginsRegistered){return}if(iconEntry.boxTween){iconEntry.boxTween.kill()}if(iconEntry.arrowTween){iconEntry.arrowTween.kill()}if(iconEntry.colorTween){iconEntry.colorTween.kill()}const targetBoxD=toHoverState?iconEntry.hoverBoxD:iconEntry.normalBoxD;const targetArrowD=toHoverState?iconEntry.hoverArrowD:iconEntry.normalArrowD;const fromStroke=toHoverState?normalStrokeColor:hoverStrokeColor;const toStroke=toHoverState?hoverStrokeColor:normalStrokeColor;iconEntry.boxTween=gsap.to(iconEntry.boxPath,{duration:animationDuration,morphSVG:targetBoxD,ease:animationEase,delay:delay});iconEntry.arrowTween=gsap.to(iconEntry.arrowPath,{duration:animationDuration,morphSVG:targetArrowD,ease:animationEase,delay:delay});iconEntry.colorTween=gsap.fromTo([iconEntry.boxPath,iconEntry.arrowPath],{stroke:fromStroke},{duration:animationDuration,stroke:toStroke,ease:animationEase,delay:delay})}function setupDesktopAnimations(){console.log("Setting up desktop animations...");if(cardsData.length===0){document.querySelectorAll(SELECTORS.CARD).forEach((cardElement)=>{const cardEntry={element:cardElement,rect:cardElement.getBoundingClientRect(),isHovered:false,mouseEnterHandler:function(){cardEntry.isHovered=true},mouseLeaveHandler:function(){cardEntry.isHovered=false}};cardsData.push(cardEntry);cardElement.addEventListener("mouseenter",cardEntry.mouseEnterHandler);cardElement.addEventListener("mouseleave",cardEntry.mouseLeaveHandler)})}if(cardAnimationId===null){document.addEventListener("mousemove",updateMousePosition);window.addEventListener("scroll",updateAllCardRects,{passive:true});window.addEventListener("resize",updateAllCardRects);cardAnimationId=requestAnimationFrame(animateCards)}if(!registerGsapPluginsOnce()){return}actionIconsData=[];const currentActionIcons=document.querySelectorAll(SELECTORS.SKILL_ITEM_ACTION_ICON);currentActionIcons.forEach((iconLink)=>{const boxPath=iconLink.querySelector(SELECTORS.MORPH_BOX_PATH);const arrowPath=iconLink.querySelector(SELECTORS.MORPH_ARROW_PATH);if(!boxPath||!arrowPath){console.warn("Morphing paths not found for an icon link:",iconLink);return}const normalBoxD=boxPath.getAttribute("d");const normalArrowD=arrowPath.getAttribute("d");const hoverBoxD="M21 13V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3H11";const hoverArrowD="M21 3L15 3M21 3L12 12M21 3V9";const iconEntry={link:iconLink,boxPath,arrowPath,normalBoxD,normalArrowD,hoverBoxD,hoverArrowD,boxTween:null,arrowTween:null,colorTween:null,};iconEntry.mouseEnterHandler=()=>animateIconState(iconEntry,true);iconEntry.mouseLeaveHandler=()=>animateIconState(iconEntry,false);iconEntry.focusHandler=()=>animateIconState(iconEntry,true,focusAnimationDelay);iconEntry.blurHandler=()=>animateIconState(iconEntry,false,focusAnimationDelay);actionIconsData.push(iconEntry);iconLink.addEventListener("mouseenter",iconEntry.mouseEnterHandler);iconLink.addEventListener("mouseleave",iconEntry.mouseLeaveHandler);iconLink.addEventListener("focus",iconEntry.focusHandler);iconLink.addEventListener("blur",iconEntry.blurHandler)});}function teardownDesktopAnimations(){console.log("Tearing down desktop animations...");if(cardAnimationId!==null){cancelAnimationFrame(cardAnimationId);cardAnimationId=null}document.removeEventListener("mousemove",updateMousePosition);window.removeEventListener("scroll",updateAllCardRects);window.removeEventListener("resize",updateAllCardRects);cardsData.forEach((data)=>{if(data.element){data.element.style.transform="";if(data.mouseEnterHandler){data.element.removeEventListener("mouseenter",data.mouseEnterHandler)}if(data.mouseLeaveHandler){data.element.removeEventListener("mouseleave",data.mouseLeaveHandler)}}});cardsData=[];actionIconsData.forEach((iconEntry)=>{if(iconEntry.boxTween){iconEntry.boxTween.kill()}if(iconEntry.arrowTween){iconEntry.arrowTween.kill()}if(iconEntry.colorTween){iconEntry.colorTween.kill()}if(gsapPluginsRegistered){if(iconEntry.boxPath){gsap.set(iconEntry.boxPath,{attr:{d:iconEntry.normalBoxD},clearProps:"stroke"})}if(iconEntry.arrowPath){gsap.set(iconEntry.arrowPath,{attr:{d:iconEntry.normalArrowD},clearProps:"stroke"})}}else{if(iconEntry.boxPath){iconEntry.boxPath.setAttribute("d",iconEntry.normalBoxD)}if(iconEntry.arrowPath){iconEntry.arrowPath.setAttribute("d",iconEntry.normalArrowD);}}if(iconEntry.link){iconEntry.link.removeEventListener("mouseenter",iconEntry.mouseEnterHandler);iconEntry.link.removeEventListener("mouseleave",iconEntry.mouseLeaveHandler);iconEntry.link.removeEventListener("focus",iconEntry.focusHandler);iconEntry.link.removeEventListener("blur",iconEntry.blurHandler)}});actionIconsData=[];}function skillItemMobileClickHandler(event){const linkElement=this.querySelector(SELECTORS.SKILL_ITEM_ACTION_ICON);if(!mediaQuery.matches&&linkElement&&linkElement.href){window.open(linkElement.href,linkElement.target||"_blank")}}function setupSkillItemMobileLinks(){console.log("Setting up mobile skill item links...");const skillItems=document.querySelectorAll(SELECTORS.SKILL_ITEM);skillItems.forEach((item)=>{if(!item.hasMobileClickHandler){item.addEventListener("click",skillItemMobileClickHandler);item.hasMobileClickHandler=true}})}function teardownSkillItemMobileLinks(){console.log("Tearing down mobile skill item links...");const skillItems=document.querySelectorAll(SELECTORS.SKILL_ITEM);skillItems.forEach((item)=>{if(item.hasMobileClickHandler){item.removeEventListener("click",skillItemMobileClickHandler);item.hasMobileClickHandler=false}})}function handleBreakpointChange(e){if(e.matches){teardownSkillItemMobileLinks();setupDesktopAnimations()}else{teardownDesktopAnimations();setupSkillItemMobileLinks()}}if(mediaQuery.matches){setupDesktopAnimations()}else{setupSkillItemMobileLinks();}mediaQuery.addEventListener("change",handleBreakpointChange);function addCloudflareAnalytics(siteToken){const script=document.createElement("script");script.defer=true;script.dataset.cfBeacon=`{"token": "${ siteToken }"}`;script.src="https://static.cloudflareinsights.com/beacon.min.js";document.body.appendChild(script);console.log(`Cloudflare Web Analytics for GitHub Pages (Token: ${ siteToken }) added to body.`)}const currentHostname=window.location.hostname;const githubPagesHostname="niiv3au.github.io";const githubPagesAnalyticsToken="e759315bc30b49adb382b087660536e2";if(currentHostname===githubPagesHostname){addCloudflareAnalytics(githubPagesAnalyticsToken)}});
